<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>4 Client-Side Components</title>
<link rel="stylesheet" type="text/css" href="/home/rails/v5.1.7/guides/output/kindle/stylesheets/kindle.css">
</head>
<body>
<h3 id="client-side-components">4 Client-Side Components</h3>
<h4 id="client-side-components-connections">4.1 Connections</h4>

<p>Consumers require an instance of the connection on their side. This can be
established using the following JavaScript, which is generated by default by Rails:</p>

<h5 id="connect-consumer">4.1.1 Connect Consumer</h5>

<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
// app/assets/javascripts/cable.js
//= require action_cable
//= require_self
//= require_tree ./channels

(function() {
  this.App || (this.App = {});

  App.cable = ActionCable.createConsumer();
}).call(this);

</pre>
</div>
<p>This will ready a consumer that'll connect against <code>/cable</code> on your server by default.
The connection won't be established until you've also specified at least one subscription
you're interested in having.</p>

<h5 id="subscriber">4.1.2 Subscriber</h5>

<p>A consumer becomes a subscriber by creating a subscription to a given channel:</p>

<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
# app/assets/javascripts/cable/subscriptions/chat.coffee
App.cable.subscriptions.create { channel: "ChatChannel", room: "Best Room" }

# app/assets/javascripts/cable/subscriptions/appearance.coffee
App.cable.subscriptions.create { channel: "AppearanceChannel" }

</pre>
</div>
<p>While this creates the subscription, the functionality needed to respond to
received data will be described later on.</p>

<p>A consumer can act as a subscriber to a given channel any number of times. For
example, a consumer could subscribe to multiple chat rooms at the same time:</p>

<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
App.cable.subscriptions.create { channel: "ChatChannel", room: "1st Room" }
App.cable.subscriptions.create { channel: "ChatChannel", room: "2nd Room" }

</pre>
</div>
</body>
</html>

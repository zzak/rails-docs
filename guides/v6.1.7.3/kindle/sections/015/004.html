<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>5 Extensions to String</title>
<link rel="stylesheet" type="text/css" href="/home/rails/v6.1.7.3/guides/output/kindle/stylesheets/kindle.css">
</head>
<body>
<h3 id="extensions-to-string"><a class="anchorlink" href="#extensions-to-string">5 Extensions to <code>String</code></a></h3>
<h4 id="output-safety"><a class="anchorlink" href="#output-safety">5.1 Output Safety</a></h4>

<h5 id="motivation"><a class="anchorlink" href="#motivation">5.1.1 Motivation</a></h5>

<p>Inserting data into HTML templates needs extra care. For example, you can't just interpolate <code>@review.title</code> verbatim into an HTML page. For one thing, if the review title is "Flanagan &amp; Matz rules!" the output won't be well-formed because an ampersand has to be escaped as "&amp;amp;". What's more, depending on the application, that may be a big security hole because users can inject malicious HTML setting a hand-crafted review title. Check out the section about cross-site scripting in the <a href="security.html#cross-site-scripting-xss">Security guide</a> for further information about the risks.</p>

<h5 id="safe-strings"><a class="anchorlink" href="#safe-strings">5.1.2 Safe Strings</a></h5>

<p>Active Support has the concept of <em>(html) safe</em> strings. A safe string is one that is marked as being insertable into HTML as is. It is trusted, no matter whether it has been escaped or not.</p>

<p>Strings are considered to be <em>unsafe</em> by default:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">""</span><span class="p">.</span><span class="nf">html_safe?</span> <span class="c1"># =&gt; false</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-785e145f0dc06350638c2cf3b1dea444">"".html_safe? # =&gt; false
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-785e145f0dc06350638c2cf3b1dea444">Copy</button>
</div>
<p>You can obtain a safe string from a given one with the <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-html_safe"><code>html_safe</code></a> method:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="n">s</span> <span class="o">=</span> <span class="s2">""</span><span class="p">.</span><span class="nf">html_safe</span>
<span class="n">s</span><span class="p">.</span><span class="nf">html_safe?</span> <span class="c1"># =&gt; true</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-84c15da7e2d8e326975c9b932d7c7e9c">s = "".html_safe
s.html_safe? # =&gt; true
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-84c15da7e2d8e326975c9b932d7c7e9c">Copy</button>
</div>
<p>It is important to understand that <code>html_safe</code> performs no escaping whatsoever, it is just an assertion:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="n">s</span> <span class="o">=</span> <span class="s2">"&lt;script&gt;...&lt;/script&gt;"</span><span class="p">.</span><span class="nf">html_safe</span>
<span class="n">s</span><span class="p">.</span><span class="nf">html_safe?</span> <span class="c1"># =&gt; true</span>
<span class="n">s</span>            <span class="c1"># =&gt; "&lt;script&gt;...&lt;/script&gt;"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-9150803ae57dfbc3e8a59d257a77163f">s = "&lt;script&gt;...&lt;/script&gt;".html_safe
s.html_safe? # =&gt; true
s            # =&gt; "&lt;script&gt;...&lt;/script&gt;"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-9150803ae57dfbc3e8a59d257a77163f">Copy</button>
</div>
<p>It is your responsibility to ensure calling <code>html_safe</code> on a particular string is fine.</p>

<p>If you append onto a safe string, either in-place with <code>concat</code>/<code>&lt;&lt;</code>, or with <code>+</code>, the result is a safe string. Unsafe arguments are escaped:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">""</span><span class="p">.</span><span class="nf">html_safe</span> <span class="o">+</span> <span class="s2">"&lt;"</span> <span class="c1"># =&gt; "&amp;lt;"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-97cb679d31539265411f35d658e98ae3">"".html_safe + "&lt;" # =&gt; "&amp;lt;"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-97cb679d31539265411f35d658e98ae3">Copy</button>
</div>
<p>Safe arguments are directly appended:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">""</span><span class="p">.</span><span class="nf">html_safe</span> <span class="o">+</span> <span class="s2">"&lt;"</span><span class="p">.</span><span class="nf">html_safe</span> <span class="c1"># =&gt; "&lt;"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-1aef1d23546bd7d1577d212f8cfc89fc">"".html_safe + "&lt;".html_safe # =&gt; "&lt;"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-1aef1d23546bd7d1577d212f8cfc89fc">Copy</button>
</div>
<p>These methods should not be used in ordinary views. Unsafe values are automatically escaped:</p>

<div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="vi">@review</span><span class="p">.</span><span class="nf">title</span> <span class="cp">%&gt;</span> <span class="c">&lt;%# fine, escaped if needed %&gt;</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-6a8ba2ca9ad4be44e87b1b25c0ac484f">&lt;%= @review.title %&gt; &lt;%# fine, escaped if needed %&gt;
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-6a8ba2ca9ad4be44e87b1b25c0ac484f">Copy</button>
</div>
<p>To insert something verbatim use the <a href="https://api.rubyonrails.org/v6.1.7.3/classes/ActionView/Helpers/OutputSafetyHelper.html#method-i-raw"><code>raw</code></a> helper rather than calling <code>html_safe</code>:</p>

<div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">raw</span> <span class="vi">@cms</span><span class="p">.</span><span class="nf">current_template</span> <span class="cp">%&gt;</span> <span class="c">&lt;%# inserts @cms.current_template as is %&gt;</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-9df3b4a9666abc6684f2aeb1006188f9">&lt;%= raw @cms.current_template %&gt; &lt;%# inserts @cms.current_template as is %&gt;
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-9df3b4a9666abc6684f2aeb1006188f9">Copy</button>
</div>
<p>or, equivalently, use <code>&lt;%==</code>:</p>

<div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span><span class="o">=</span> <span class="vi">@cms</span><span class="p">.</span><span class="nf">current_template</span> <span class="cp">%&gt;</span> <span class="c">&lt;%# inserts @cms.current_template as is %&gt;</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-fe0de776eea2e0dd4d4be867410037b6">&lt;%== @cms.current_template %&gt; &lt;%# inserts @cms.current_template as is %&gt;
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-fe0de776eea2e0dd4d4be867410037b6">Copy</button>
</div>
<p>The <code>raw</code> helper calls <code>html_safe</code> for you:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">raw</span><span class="p">(</span><span class="n">stringish</span><span class="p">)</span>
  <span class="n">stringish</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">html_safe</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-958a6a4f0018b7d651d4717f0c438ae8">def raw(stringish)
  stringish.to_s.html_safe
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-958a6a4f0018b7d651d4717f0c438ae8">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/output_safety.rb">active_support/core_ext/string/output_safety.rb</a></code>.</p></div>

<h5 id="transformation"><a class="anchorlink" href="#transformation">5.1.3 Transformation</a></h5>

<p>As a rule of thumb, except perhaps for concatenation as explained above, any method that may change a string gives you an unsafe string. These are <code>downcase</code>, <code>gsub</code>, <code>strip</code>, <code>chomp</code>, <code>underscore</code>, etc.</p>

<p>In the case of in-place transformations like <code>gsub!</code> the receiver itself becomes unsafe.</p>

<div class="info"><p>The safety bit is lost always, no matter whether the transformation actually changed something.</p></div>

<h5 id="conversion-and-coercion"><a class="anchorlink" href="#conversion-and-coercion">5.1.4 Conversion and Coercion</a></h5>

<p>Calling <code>to_s</code> on a safe string returns a safe string, but coercion with <code>to_str</code> returns an unsafe string.</p>

<h5 id="copying"><a class="anchorlink" href="#copying">5.1.5 Copying</a></h5>

<p>Calling <code>dup</code> or <code>clone</code> on safe strings yields safe strings.</p>

<h4 id="remove"><a class="anchorlink" href="#remove">5.2 <code>remove</code></a></h4>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-remove"><code>remove</code></a> will remove all occurrences of the pattern:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Hello World"</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="sr">/Hello /</span><span class="p">)</span> <span class="c1"># =&gt; "World"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-96e5d59ef3fa499215b3d4e24620244e">"Hello World".remove(/Hello /) # =&gt; "World"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-96e5d59ef3fa499215b3d4e24620244e">Copy</button>
</div>
<p>There's also the destructive version <code>String#remove!</code>.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/filters.rb">active_support/core_ext/string/filters.rb</a></code>.</p></div>

<h4 id="squish"><a class="anchorlink" href="#squish">5.3 <code>squish</code></a></h4>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-squish"><code>squish</code></a> strips leading and trailing whitespace, and substitutes runs of whitespace with a single space each:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">" </span><span class="se">\n</span><span class="s2">  foo</span><span class="se">\n\r</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> bar </span><span class="se">\n</span><span class="s2">"</span><span class="p">.</span><span class="nf">squish</span> <span class="c1"># =&gt; "foo bar"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-2366823feee332baee46fd04c328cdcb">" \n  foo\n\r \t bar \n".squish # =&gt; "foo bar"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-2366823feee332baee46fd04c328cdcb">Copy</button>
</div>
<p>There's also the destructive version <code>String#squish!</code>.</p>

<p>Note that it handles both ASCII and Unicode whitespace.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/filters.rb">active_support/core_ext/string/filters.rb</a></code>.</p></div>

<h4 id="truncate"><a class="anchorlink" href="#truncate">5.4 <code>truncate</code></a></h4>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-truncate"><code>truncate</code></a> returns a copy of its receiver truncated after a given <code>length</code>:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Oh dear! Oh dear! I shall be late!"</span><span class="p">.</span><span class="nf">truncate</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># =&gt; "Oh dear! Oh dear!..."</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-5018bf4ff4754a99bf84d2a7f75ee4b4">"Oh dear! Oh dear! I shall be late!".truncate(20)
# =&gt; "Oh dear! Oh dear!..."
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-5018bf4ff4754a99bf84d2a7f75ee4b4">Copy</button>
</div>
<p>Ellipsis can be customized with the <code>:omission</code> option:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Oh dear! Oh dear! I shall be late!"</span><span class="p">.</span><span class="nf">truncate</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="ss">omission: </span><span class="s1">'&amp;hellip;'</span><span class="p">)</span>
<span class="c1"># =&gt; "Oh dear! Oh &amp;hellip;"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-cbc73ad6d3263395335cf196302d3b50">"Oh dear! Oh dear! I shall be late!".truncate(20, omission: '&amp;hellip;')
# =&gt; "Oh dear! Oh &amp;hellip;"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-cbc73ad6d3263395335cf196302d3b50">Copy</button>
</div>
<p>Note in particular that truncation takes into account the length of the omission string.</p>

<p>Pass a <code>:separator</code> to truncate the string at a natural break:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Oh dear! Oh dear! I shall be late!"</span><span class="p">.</span><span class="nf">truncate</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="c1"># =&gt; "Oh dear! Oh dea..."</span>
<span class="s2">"Oh dear! Oh dear! I shall be late!"</span><span class="p">.</span><span class="nf">truncate</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="ss">separator: </span><span class="s1">' '</span><span class="p">)</span>
<span class="c1"># =&gt; "Oh dear! Oh..."</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-4f05a1d9b3c14a27272414fb83c9ed66">"Oh dear! Oh dear! I shall be late!".truncate(18)
# =&gt; "Oh dear! Oh dea..."
"Oh dear! Oh dear! I shall be late!".truncate(18, separator: ' ')
# =&gt; "Oh dear! Oh..."
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-4f05a1d9b3c14a27272414fb83c9ed66">Copy</button>
</div>
<p>The option <code>:separator</code> can be a regexp:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Oh dear! Oh dear! I shall be late!"</span><span class="p">.</span><span class="nf">truncate</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="ss">separator: </span><span class="sr">/\s/</span><span class="p">)</span>
<span class="c1"># =&gt; "Oh dear! Oh..."</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-c3fc3d66dfa3977580626ef4c070c240">"Oh dear! Oh dear! I shall be late!".truncate(18, separator: /\s/)
# =&gt; "Oh dear! Oh..."
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-c3fc3d66dfa3977580626ef4c070c240">Copy</button>
</div>
<p>In above examples "dear" gets cut first, but then <code>:separator</code> prevents it.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/filters.rb">active_support/core_ext/string/filters.rb</a></code>.</p></div>

<h4 id="truncate-bytes"><a class="anchorlink" href="#truncate-bytes">5.5 <code>truncate_bytes</code></a></h4>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-truncate_bytes"><code>truncate_bytes</code></a> returns a copy of its receiver truncated to at most <code>bytesize</code> bytes:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"👍👍👍👍"</span><span class="p">.</span><span class="nf">truncate_bytes</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="c1"># =&gt; "👍👍👍…"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-c8ce8790ee2ba58fc50b858fa2459bf3">"👍👍👍👍".truncate_bytes(15)
# =&gt; "👍👍👍…"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-c8ce8790ee2ba58fc50b858fa2459bf3">Copy</button>
</div>
<p>Ellipsis can be customized with the <code>:omission</code> option:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"👍👍👍👍"</span><span class="p">.</span><span class="nf">truncate_bytes</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="ss">omission: </span><span class="s2">"🖖"</span><span class="p">)</span>
<span class="c1"># =&gt; "👍👍🖖"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-3fed6094747416c7bef76e1b7828156e">"👍👍👍👍".truncate_bytes(15, omission: "🖖")
# =&gt; "👍👍🖖"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-3fed6094747416c7bef76e1b7828156e">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/filters.rb">active_support/core_ext/string/filters.rb</a></code>.</p></div>

<h4 id="truncate-words"><a class="anchorlink" href="#truncate-words">5.6 <code>truncate_words</code></a></h4>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-truncate_words"><code>truncate_words</code></a> returns a copy of its receiver truncated after a given number of words:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Oh dear! Oh dear! I shall be late!"</span><span class="p">.</span><span class="nf">truncate_words</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># =&gt; "Oh dear! Oh dear!..."</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-d24d919603619758a23ce397253c2254">"Oh dear! Oh dear! I shall be late!".truncate_words(4)
# =&gt; "Oh dear! Oh dear!..."
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-d24d919603619758a23ce397253c2254">Copy</button>
</div>
<p>Ellipsis can be customized with the <code>:omission</code> option:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Oh dear! Oh dear! I shall be late!"</span><span class="p">.</span><span class="nf">truncate_words</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="ss">omission: </span><span class="s1">'&amp;hellip;'</span><span class="p">)</span>
<span class="c1"># =&gt; "Oh dear! Oh dear!&amp;hellip;"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-b4c476378cdef472838642d6764afed6">"Oh dear! Oh dear! I shall be late!".truncate_words(4, omission: '&amp;hellip;')
# =&gt; "Oh dear! Oh dear!&amp;hellip;"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-b4c476378cdef472838642d6764afed6">Copy</button>
</div>
<p>Pass a <code>:separator</code> to truncate the string at a natural break:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Oh dear! Oh dear! I shall be late!"</span><span class="p">.</span><span class="nf">truncate_words</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="ss">separator: </span><span class="s1">'!'</span><span class="p">)</span>
<span class="c1"># =&gt; "Oh dear! Oh dear! I shall be late..."</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-3c048400d1fff7202cb682be93fee712">"Oh dear! Oh dear! I shall be late!".truncate_words(3, separator: '!')
# =&gt; "Oh dear! Oh dear! I shall be late..."
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-3c048400d1fff7202cb682be93fee712">Copy</button>
</div>
<p>The option <code>:separator</code> can be a regexp:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Oh dear! Oh dear! I shall be late!"</span><span class="p">.</span><span class="nf">truncate_words</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="ss">separator: </span><span class="sr">/\s/</span><span class="p">)</span>
<span class="c1"># =&gt; "Oh dear! Oh dear!..."</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-dde7421cc034e6575ec4efab11ed4b29">"Oh dear! Oh dear! I shall be late!".truncate_words(4, separator: /\s/)
# =&gt; "Oh dear! Oh dear!..."
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-dde7421cc034e6575ec4efab11ed4b29">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/filters.rb">active_support/core_ext/string/filters.rb</a></code>.</p></div>

<h4 id="inquiry"><a class="anchorlink" href="#inquiry">5.7 <code>inquiry</code></a></h4>

<p>The <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-inquiry"><code>inquiry</code></a> method converts a string into a <code>StringInquirer</code> object making equality checks prettier.</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"production"</span><span class="p">.</span><span class="nf">inquiry</span><span class="p">.</span><span class="nf">production?</span> <span class="c1"># =&gt; true</span>
<span class="s2">"active"</span><span class="p">.</span><span class="nf">inquiry</span><span class="p">.</span><span class="nf">inactive?</span>       <span class="c1"># =&gt; false</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-21662ddf366a9d4c7509a025b6e7d127">"production".inquiry.production? # =&gt; true
"active".inquiry.inactive?       # =&gt; false
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-21662ddf366a9d4c7509a025b6e7d127">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inquiry.rb">active_support/core_ext/string/inquiry.rb</a></code>.</p></div>

<h4 id="extensions-to-string-starts-with-questionmark-and-ends-with-questionmark"><a class="anchorlink" href="#extensions-to-string-starts-with-questionmark-and-ends-with-questionmark">5.8 <code>starts_with?</code> and <code>ends_with?</code></a></h4>

<p>Active Support defines 3rd person aliases of <code>String#start_with?</code> and <code>String#end_with?</code>:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"foo"</span><span class="p">.</span><span class="nf">starts_with?</span><span class="p">(</span><span class="s2">"f"</span><span class="p">)</span> <span class="c1"># =&gt; true</span>
<span class="s2">"foo"</span><span class="p">.</span><span class="nf">ends_with?</span><span class="p">(</span><span class="s2">"o"</span><span class="p">)</span>   <span class="c1"># =&gt; true</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-3d0469aca86e6fbe1c3892f5e9bac5ef">"foo".starts_with?("f") # =&gt; true
"foo".ends_with?("o")   # =&gt; true
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-3d0469aca86e6fbe1c3892f5e9bac5ef">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/starts_ends_with.rb">active_support/core_ext/string/starts_ends_with.rb</a></code>.</p></div>

<h4 id="strip-heredoc"><a class="anchorlink" href="#strip-heredoc">5.9 <code>strip_heredoc</code></a></h4>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-strip_heredoc"><code>strip_heredoc</code></a> strips indentation in heredocs.</p>

<p>For example in</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="ss">:usage</span><span class="p">]</span>
  <span class="nb">puts</span> <span class="o">&lt;&lt;-</span><span class="no">USAGE</span><span class="p">.</span><span class="nf">strip_heredoc</span><span class="sh">
    This command does such and such.

    Supported options are:
      -h         This message
      ...
</span><span class="no">  USAGE</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-8eb790f96472aea4b93ea744ab21f611">if options[:usage]
  puts &lt;&lt;-USAGE.strip_heredoc
    This command does such and such.

    Supported options are:
      -h         This message
      ...
  USAGE
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-8eb790f96472aea4b93ea744ab21f611">Copy</button>
</div>
<p>the user would see the usage message aligned against the left margin.</p>

<p>Technically, it looks for the least indented line in the whole string, and removes
that amount of leading whitespace.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/strip.rb">active_support/core_ext/string/strip.rb</a></code>.</p></div>

<h4 id="indent"><a class="anchorlink" href="#indent">5.10 <code>indent</code></a></h4>

<p>The <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-indent"><code>indent</code></a> method indents the lines in the receiver:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="o">&lt;&lt;</span><span class="no">EOS</span><span class="p">.</span><span class="nf">indent</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="sh">
def some_method
  some_code
end
</span><span class="no">EOS</span>
<span class="c1"># =&gt;</span>
  <span class="k">def</span> <span class="nf">some_method</span>
    <span class="n">some_code</span>
  <span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-c1ac531b872daee2056435fcd51c5642">&lt;&lt;EOS.indent(2)
def some_method
  some_code
end
EOS
# =&gt;
  def some_method
    some_code
  end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-c1ac531b872daee2056435fcd51c5642">Copy</button>
</div>
<p>The second argument, <code>indent_string</code>, specifies which indent string to use. The default is <code>nil</code>, which tells the method to make an educated guess peeking at the first indented line, and fallback to a space if there is none.</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"  foo"</span><span class="p">.</span><span class="nf">indent</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>        <span class="c1"># =&gt; "    foo"</span>
<span class="s2">"foo</span><span class="se">\n\t\t</span><span class="s2">bar"</span><span class="p">.</span><span class="nf">indent</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># =&gt; "\t\tfoo\n\t\t\t\tbar"</span>
<span class="s2">"foo"</span><span class="p">.</span><span class="nf">indent</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">)</span>    <span class="c1"># =&gt; "\t\tfoo"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-07c3e4bcb348d59afa174b61518f4ccc">"  foo".indent(2)        # =&gt; "    foo"
"foo\n\t\tbar".indent(2) # =&gt; "\t\tfoo\n\t\t\t\tbar"
"foo".indent(2, "\t")    # =&gt; "\t\tfoo"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-07c3e4bcb348d59afa174b61518f4ccc">Copy</button>
</div>
<p>While <code>indent_string</code> is typically one space or tab, it may be any string.</p>

<p>The third argument, <code>indent_empty_lines</code>, is a flag that says whether empty lines should be indented. Default is false.</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"foo</span><span class="se">\n\n</span><span class="s2">bar"</span><span class="p">.</span><span class="nf">indent</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>            <span class="c1"># =&gt; "  foo\n\n  bar"</span>
<span class="s2">"foo</span><span class="se">\n\n</span><span class="s2">bar"</span><span class="p">.</span><span class="nf">indent</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span> <span class="c1"># =&gt; "  foo\n  \n  bar"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-a0a6a77023256c741260d054660dadc9">"foo\n\nbar".indent(2)            # =&gt; "  foo\n\n  bar"
"foo\n\nbar".indent(2, nil, true) # =&gt; "  foo\n  \n  bar"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-a0a6a77023256c741260d054660dadc9">Copy</button>
</div>
<p>The <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-indent-21"><code>indent!</code></a> method performs indentation in-place.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/indent.rb">active_support/core_ext/string/indent.rb</a></code>.</p></div>

<h4 id="access"><a class="anchorlink" href="#access">5.11 Access</a></h4>

<h5 id="at-position"><a class="anchorlink" href="#at-position">5.11.1 <code>at(position)</code></a></h5>

<p>The <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-at"><code>at</code></a> method returns the character of the string at position <code>position</code>:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"hello"</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># =&gt; "h"</span>
<span class="s2">"hello"</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># =&gt; "o"</span>
<span class="s2">"hello"</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># =&gt; "o"</span>
<span class="s2">"hello"</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># =&gt; nil</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-14a3d11a1ca69668bd88dd70193bf3ef">"hello".at(0)  # =&gt; "h"
"hello".at(4)  # =&gt; "o"
"hello".at(-1) # =&gt; "o"
"hello".at(10) # =&gt; nil
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-14a3d11a1ca69668bd88dd70193bf3ef">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/access.rb">active_support/core_ext/string/access.rb</a></code>.</p></div>

<h5 id="from-position"><a class="anchorlink" href="#from-position">5.11.2 <code>from(position)</code></a></h5>

<p>The <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-from"><code>from</code></a> method returns the substring of the string starting at position <code>position</code>:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"hello"</span><span class="p">.</span><span class="nf">from</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># =&gt; "hello"</span>
<span class="s2">"hello"</span><span class="p">.</span><span class="nf">from</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># =&gt; "llo"</span>
<span class="s2">"hello"</span><span class="p">.</span><span class="nf">from</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># =&gt; "lo"</span>
<span class="s2">"hello"</span><span class="p">.</span><span class="nf">from</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># =&gt; nil</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-05940be4e08a6063b319d5aa5e2c5988">"hello".from(0)  # =&gt; "hello"
"hello".from(2)  # =&gt; "llo"
"hello".from(-2) # =&gt; "lo"
"hello".from(10) # =&gt; nil
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-05940be4e08a6063b319d5aa5e2c5988">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/access.rb">active_support/core_ext/string/access.rb</a></code>.</p></div>

<h5 id="to-position"><a class="anchorlink" href="#to-position">5.11.3 <code>to(position)</code></a></h5>

<p>The <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-to"><code>to</code></a> method returns the substring of the string up to position <code>position</code>:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"hello"</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># =&gt; "h"</span>
<span class="s2">"hello"</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># =&gt; "hel"</span>
<span class="s2">"hello"</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># =&gt; "hell"</span>
<span class="s2">"hello"</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># =&gt; "hello"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-25b2dd314f610f15e0f3d27dbc432549">"hello".to(0)  # =&gt; "h"
"hello".to(2)  # =&gt; "hel"
"hello".to(-2) # =&gt; "hell"
"hello".to(10) # =&gt; "hello"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-25b2dd314f610f15e0f3d27dbc432549">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/access.rb">active_support/core_ext/string/access.rb</a></code>.</p></div>

<h5 id="first-limit-1"><a class="anchorlink" href="#first-limit-1">5.11.4 <code>first(limit = 1)</code></a></h5>

<p>The <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-first"><code>first</code></a> method returns a substring containing the first <code>limit</code> characters of the string.</p>

<p>The call <code>str.first(n)</code> is equivalent to <code>str.to(n-1)</code> if <code>n</code> &gt; 0, and returns an empty string for <code>n</code> == 0.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/access.rb">active_support/core_ext/string/access.rb</a></code>.</p></div>

<h5 id="last-limit-1"><a class="anchorlink" href="#last-limit-1">5.11.5 <code>last(limit = 1)</code></a></h5>

<p>The <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-last"><code>last</code></a> method returns a substring containing the last <code>limit</code> characters of the string.</p>

<p>The call <code>str.last(n)</code> is equivalent to <code>str.from(-n)</code> if <code>n</code> &gt; 0, and returns an empty string for <code>n</code> == 0.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/access.rb">active_support/core_ext/string/access.rb</a></code>.</p></div>

<h4 id="inflections"><a class="anchorlink" href="#inflections">5.12 Inflections</a></h4>

<h5 id="pluralize"><a class="anchorlink" href="#pluralize">5.12.1 <code>pluralize</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-pluralize"><code>pluralize</code></a> returns the plural of its receiver:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"table"</span><span class="p">.</span><span class="nf">pluralize</span>     <span class="c1"># =&gt; "tables"</span>
<span class="s2">"ruby"</span><span class="p">.</span><span class="nf">pluralize</span>      <span class="c1"># =&gt; "rubies"</span>
<span class="s2">"equipment"</span><span class="p">.</span><span class="nf">pluralize</span> <span class="c1"># =&gt; "equipment"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-b4c37524edf2f85d5af3c38d54777661">"table".pluralize     # =&gt; "tables"
"ruby".pluralize      # =&gt; "rubies"
"equipment".pluralize # =&gt; "equipment"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-b4c37524edf2f85d5af3c38d54777661">Copy</button>
</div>
<p>As the previous example shows, Active Support knows some irregular plurals and uncountable nouns. Built-in rules can be extended in <code>config/initializers/inflections.rb</code>. This file is generated by default, by the <code>rails new</code> command and has instructions in comments.</p>

<p><code>pluralize</code> can also take an optional <code>count</code> parameter. If <code>count == 1</code> the singular form will be returned. For any other value of <code>count</code> the plural form will be returned:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"dude"</span><span class="p">.</span><span class="nf">pluralize</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># =&gt; "dudes"</span>
<span class="s2">"dude"</span><span class="p">.</span><span class="nf">pluralize</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># =&gt; "dude"</span>
<span class="s2">"dude"</span><span class="p">.</span><span class="nf">pluralize</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># =&gt; "dudes"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-cf3ac33f3096671ca1e50271abf93fdb">"dude".pluralize(0) # =&gt; "dudes"
"dude".pluralize(1) # =&gt; "dude"
"dude".pluralize(2) # =&gt; "dudes"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-cf3ac33f3096671ca1e50271abf93fdb">Copy</button>
</div>
<p>Active Record uses this method to compute the default table name that corresponds to a model:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># active_record/model_schema.rb</span>
<span class="k">def</span> <span class="nf">undecorated_table_name</span><span class="p">(</span><span class="n">class_name</span> <span class="o">=</span> <span class="n">base_class</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span>
  <span class="n">table_name</span> <span class="o">=</span> <span class="n">class_name</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">demodulize</span><span class="p">.</span><span class="nf">underscore</span>
  <span class="n">pluralize_table_names</span> <span class="p">?</span> <span class="n">table_name</span><span class="p">.</span><span class="nf">pluralize</span> <span class="p">:</span> <span class="n">table_name</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-646150dfe51ebf20521ff14bda1acb7c"># active_record/model_schema.rb
def undecorated_table_name(class_name = base_class.name)
  table_name = class_name.to_s.demodulize.underscore
  pluralize_table_names ? table_name.pluralize : table_name
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-646150dfe51ebf20521ff14bda1acb7c">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="singularize"><a class="anchorlink" href="#singularize">5.12.2 <code>singularize</code></a></h5>

<p>The <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-singularize"><code>singularize</code></a> method is the inverse of <code>pluralize</code>:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"tables"</span><span class="p">.</span><span class="nf">singularize</span>    <span class="c1"># =&gt; "table"</span>
<span class="s2">"rubies"</span><span class="p">.</span><span class="nf">singularize</span>    <span class="c1"># =&gt; "ruby"</span>
<span class="s2">"equipment"</span><span class="p">.</span><span class="nf">singularize</span> <span class="c1"># =&gt; "equipment"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-7569121b5b440e42026ce0d79a7aa229">"tables".singularize    # =&gt; "table"
"rubies".singularize    # =&gt; "ruby"
"equipment".singularize # =&gt; "equipment"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-7569121b5b440e42026ce0d79a7aa229">Copy</button>
</div>
<p>Associations compute the name of the corresponding default associated class using this method:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># active_record/reflection.rb</span>
<span class="k">def</span> <span class="nf">derive_class_name</span>
  <span class="n">class_name</span> <span class="o">=</span> <span class="nb">name</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">camelize</span>
  <span class="n">class_name</span> <span class="o">=</span> <span class="n">class_name</span><span class="p">.</span><span class="nf">singularize</span> <span class="k">if</span> <span class="n">collection?</span>
  <span class="n">class_name</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-d5bb70074695cf5c7630d312eda8dc9f"># active_record/reflection.rb
def derive_class_name
  class_name = name.to_s.camelize
  class_name = class_name.singularize if collection?
  class_name
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-d5bb70074695cf5c7630d312eda8dc9f">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="camelize"><a class="anchorlink" href="#camelize">5.12.3 <code>camelize</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-camelize"><code>camelize</code></a> returns its receiver in camel case:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"product"</span><span class="p">.</span><span class="nf">camelize</span>    <span class="c1"># =&gt; "Product"</span>
<span class="s2">"admin_user"</span><span class="p">.</span><span class="nf">camelize</span> <span class="c1"># =&gt; "AdminUser"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-597a4e21313f9dde05122a4ec6f5a31e">"product".camelize    # =&gt; "Product"
"admin_user".camelize # =&gt; "AdminUser"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-597a4e21313f9dde05122a4ec6f5a31e">Copy</button>
</div>
<p>As a rule of thumb you can think of this method as the one that transforms paths into Ruby class or module names, where slashes separate namespaces:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"backoffice/session"</span><span class="p">.</span><span class="nf">camelize</span> <span class="c1"># =&gt; "Backoffice::Session"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-3cb4768e0bc0890da8d169de6a77eec4">"backoffice/session".camelize # =&gt; "Backoffice::Session"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-3cb4768e0bc0890da8d169de6a77eec4">Copy</button>
</div>
<p>For example, Action Pack uses this method to load the class that provides a certain session store:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># action_controller/metal/session_management.rb</span>
<span class="k">def</span> <span class="nf">session_store</span><span class="o">=</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
  <span class="vc">@@session_store</span> <span class="o">=</span> <span class="n">store</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Symbol</span><span class="p">)</span> <span class="p">?</span>
    <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">Session</span><span class="p">.</span><span class="nf">const_get</span><span class="p">(</span><span class="n">store</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">camelize</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">store</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-e90699ebed83e49bb00f92c1ef0490c2"># action_controller/metal/session_management.rb
def session_store=(store)
  @@session_store = store.is_a?(Symbol) ?
    ActionDispatch::Session.const_get(store.to_s.camelize) :
    store
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-e90699ebed83e49bb00f92c1ef0490c2">Copy</button>
</div>
<p><code>camelize</code> accepts an optional argument, it can be <code>:upper</code> (default), or <code>:lower</code>. With the latter the first letter becomes lowercase:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"visual_effect"</span><span class="p">.</span><span class="nf">camelize</span><span class="p">(</span><span class="ss">:lower</span><span class="p">)</span> <span class="c1"># =&gt; "visualEffect"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-575426da6c0be334f86e28612f054298">"visual_effect".camelize(:lower) # =&gt; "visualEffect"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-575426da6c0be334f86e28612f054298">Copy</button>
</div>
<p>That may be handy to compute method names in a language that follows that convention, for example JavaScript.</p>

<div class="info"><p>As a rule of thumb you can think of <code>camelize</code> as the inverse of <code>underscore</code>, though there are cases where that does not hold: <code>"SSLError".underscore.camelize</code> gives back <code>"SslError"</code>. To support cases such as this, Active Support allows you to specify acronyms in <code>config/initializers/inflections.rb</code>:</p></div>

<div class="code_container">
<pre><code class="highlight ruby"><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Inflector</span><span class="p">.</span><span class="nf">inflections</span> <span class="k">do</span> <span class="o">|</span><span class="n">inflect</span><span class="o">|</span>
  <span class="n">inflect</span><span class="p">.</span><span class="nf">acronym</span> <span class="s1">'SSL'</span>
<span class="k">end</span>

<span class="s2">"SSLError"</span><span class="p">.</span><span class="nf">underscore</span><span class="p">.</span><span class="nf">camelize</span> <span class="c1"># =&gt; "SSLError"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-e368b8e3f369907d2eea13e4063ec571">ActiveSupport::Inflector.inflections do |inflect|
  inflect.acronym 'SSL'
end

"SSLError".underscore.camelize # =&gt; "SSLError"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-e368b8e3f369907d2eea13e4063ec571">Copy</button>
</div>
<p><code>camelize</code> is aliased to <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-camelcase"><code>camelcase</code></a>.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="underscore"><a class="anchorlink" href="#underscore">5.12.4 <code>underscore</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-underscore"><code>underscore</code></a> goes the other way around, from camel case to paths:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Product"</span><span class="p">.</span><span class="nf">underscore</span>   <span class="c1"># =&gt; "product"</span>
<span class="s2">"AdminUser"</span><span class="p">.</span><span class="nf">underscore</span> <span class="c1"># =&gt; "admin_user"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-efdde599f44dfead8298ece771a24f9f">"Product".underscore   # =&gt; "product"
"AdminUser".underscore # =&gt; "admin_user"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-efdde599f44dfead8298ece771a24f9f">Copy</button>
</div>
<p>Also converts "::" back to "/":</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Backoffice::Session"</span><span class="p">.</span><span class="nf">underscore</span> <span class="c1"># =&gt; "backoffice/session"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-123383856e8c99446ee2bcda774e94bc">"Backoffice::Session".underscore # =&gt; "backoffice/session"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-123383856e8c99446ee2bcda774e94bc">Copy</button>
</div>
<p>and understands strings that start with lowercase:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"visualEffect"</span><span class="p">.</span><span class="nf">underscore</span> <span class="c1"># =&gt; "visual_effect"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-c4518bf680fd7828d8ac5d89464817bd">"visualEffect".underscore # =&gt; "visual_effect"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-c4518bf680fd7828d8ac5d89464817bd">Copy</button>
</div>
<p><code>underscore</code> accepts no argument though.</p>

<p>Rails class and module autoloading uses <code>underscore</code> to infer the relative path without extension of a file that would define a given missing constant:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># active_support/dependencies.rb</span>
<span class="k">def</span> <span class="nf">load_missing_constant</span><span class="p">(</span><span class="n">from_mod</span><span class="p">,</span> <span class="n">const_name</span><span class="p">)</span>
  <span class="c1"># ...</span>
  <span class="n">qualified_name</span> <span class="o">=</span> <span class="n">qualified_name_for</span> <span class="n">from_mod</span><span class="p">,</span> <span class="n">const_name</span>
  <span class="n">path_suffix</span> <span class="o">=</span> <span class="n">qualified_name</span><span class="p">.</span><span class="nf">underscore</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-d27e3b652192a395f18f2e5534b6fb91"># active_support/dependencies.rb
def load_missing_constant(from_mod, const_name)
  # ...
  qualified_name = qualified_name_for from_mod, const_name
  path_suffix = qualified_name.underscore
  # ...
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-d27e3b652192a395f18f2e5534b6fb91">Copy</button>
</div>
<div class="info"><p>As a rule of thumb you can think of <code>underscore</code> as the inverse of <code>camelize</code>, though there are cases where that does not hold. For example, <code>"SSLError".underscore.camelize</code> gives back <code>"SslError"</code>.</p></div>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="titleize"><a class="anchorlink" href="#titleize">5.12.5 <code>titleize</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-titleize"><code>titleize</code></a> capitalizes the words in the receiver:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"alice in wonderland"</span><span class="p">.</span><span class="nf">titleize</span> <span class="c1"># =&gt; "Alice In Wonderland"</span>
<span class="s2">"fermat's enigma"</span><span class="p">.</span><span class="nf">titleize</span>     <span class="c1"># =&gt; "Fermat's Enigma"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-93bb3f4a079bd573bcde68a79e8da88e">"alice in wonderland".titleize # =&gt; "Alice In Wonderland"
"fermat's enigma".titleize     # =&gt; "Fermat's Enigma"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-93bb3f4a079bd573bcde68a79e8da88e">Copy</button>
</div>
<p><code>titleize</code> is aliased to <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-titlecase"><code>titlecase</code></a>.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="dasherize"><a class="anchorlink" href="#dasherize">5.12.6 <code>dasherize</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-dasherize"><code>dasherize</code></a> replaces the underscores in the receiver with dashes:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"name"</span><span class="p">.</span><span class="nf">dasherize</span>         <span class="c1"># =&gt; "name"</span>
<span class="s2">"contact_data"</span><span class="p">.</span><span class="nf">dasherize</span> <span class="c1"># =&gt; "contact-data"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-ffed4092366b231bd2d8c2ecb3ae573a">"name".dasherize         # =&gt; "name"
"contact_data".dasherize # =&gt; "contact-data"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-ffed4092366b231bd2d8c2ecb3ae573a">Copy</button>
</div>
<p>The XML serializer of models uses this method to dasherize node names:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># active_model/serializers/xml.rb</span>
<span class="k">def</span> <span class="nf">reformat_name</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
  <span class="nb">name</span> <span class="o">=</span> <span class="nb">name</span><span class="p">.</span><span class="nf">camelize</span> <span class="k">if</span> <span class="n">camelize?</span>
  <span class="n">dasherize?</span> <span class="p">?</span> <span class="nb">name</span><span class="p">.</span><span class="nf">dasherize</span> <span class="p">:</span> <span class="nb">name</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-5549d7fc1b49a4ca33de3eaff1971899"># active_model/serializers/xml.rb
def reformat_name(name)
  name = name.camelize if camelize?
  dasherize? ? name.dasherize : name
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-5549d7fc1b49a4ca33de3eaff1971899">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="demodulize"><a class="anchorlink" href="#demodulize">5.12.7 <code>demodulize</code></a></h5>

<p>Given a string with a qualified constant name, <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-demodulize"><code>demodulize</code></a> returns the very constant name, that is, the rightmost part of it:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Product"</span><span class="p">.</span><span class="nf">demodulize</span>                        <span class="c1"># =&gt; "Product"</span>
<span class="s2">"Backoffice::UsersController"</span><span class="p">.</span><span class="nf">demodulize</span>    <span class="c1"># =&gt; "UsersController"</span>
<span class="s2">"Admin::Hotel::ReservationUtils"</span><span class="p">.</span><span class="nf">demodulize</span> <span class="c1"># =&gt; "ReservationUtils"</span>
<span class="s2">"::Inflections"</span><span class="p">.</span><span class="nf">demodulize</span>                  <span class="c1"># =&gt; "Inflections"</span>
<span class="s2">""</span><span class="p">.</span><span class="nf">demodulize</span>                               <span class="c1"># =&gt; ""</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-1477fd4e8a0f42e2a67613d99be000ba">"Product".demodulize                        # =&gt; "Product"
"Backoffice::UsersController".demodulize    # =&gt; "UsersController"
"Admin::Hotel::ReservationUtils".demodulize # =&gt; "ReservationUtils"
"::Inflections".demodulize                  # =&gt; "Inflections"
"".demodulize                               # =&gt; ""
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-1477fd4e8a0f42e2a67613d99be000ba">Copy</button>
</div>
<p>Active Record for example uses this method to compute the name of a counter cache column:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># active_record/reflection.rb</span>
<span class="k">def</span> <span class="nf">counter_cache_column</span>
  <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="ss">:counter_cache</span><span class="p">]</span> <span class="o">==</span> <span class="kp">true</span>
    <span class="s2">"</span><span class="si">#{</span><span class="n">active_record</span><span class="p">.</span><span class="nf">name</span><span class="p">.</span><span class="nf">demodulize</span><span class="p">.</span><span class="nf">underscore</span><span class="p">.</span><span class="nf">pluralize</span><span class="si">}</span><span class="s2">_count"</span>
  <span class="k">elsif</span> <span class="n">options</span><span class="p">[</span><span class="ss">:counter_cache</span><span class="p">]</span>
    <span class="n">options</span><span class="p">[</span><span class="ss">:counter_cache</span><span class="p">]</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-a3772a8e90ee6076b948b620950ddb4b"># active_record/reflection.rb
def counter_cache_column
  if options[:counter_cache] == true
    "#{active_record.name.demodulize.underscore.pluralize}_count"
  elsif options[:counter_cache]
    options[:counter_cache]
  end
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-a3772a8e90ee6076b948b620950ddb4b">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="deconstantize"><a class="anchorlink" href="#deconstantize">5.12.8 <code>deconstantize</code></a></h5>

<p>Given a string with a qualified constant reference expression, <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-deconstantize"><code>deconstantize</code></a> removes the rightmost segment, generally leaving the name of the constant's container:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Product"</span><span class="p">.</span><span class="nf">deconstantize</span>                        <span class="c1"># =&gt; ""</span>
<span class="s2">"Backoffice::UsersController"</span><span class="p">.</span><span class="nf">deconstantize</span>    <span class="c1"># =&gt; "Backoffice"</span>
<span class="s2">"Admin::Hotel::ReservationUtils"</span><span class="p">.</span><span class="nf">deconstantize</span> <span class="c1"># =&gt; "Admin::Hotel"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-dc110c37fbf0ef418a6721b68c56a341">"Product".deconstantize                        # =&gt; ""
"Backoffice::UsersController".deconstantize    # =&gt; "Backoffice"
"Admin::Hotel::ReservationUtils".deconstantize # =&gt; "Admin::Hotel"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-dc110c37fbf0ef418a6721b68c56a341">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="parameterize"><a class="anchorlink" href="#parameterize">5.12.9 <code>parameterize</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-parameterize"><code>parameterize</code></a> normalizes its receiver in a way that can be used in pretty URLs.</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"John Smith"</span><span class="p">.</span><span class="nf">parameterize</span> <span class="c1"># =&gt; "john-smith"</span>
<span class="s2">"Kurt Gödel"</span><span class="p">.</span><span class="nf">parameterize</span> <span class="c1"># =&gt; "kurt-godel"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-9cecbda39cbbe18e63e03861113159ce">"John Smith".parameterize # =&gt; "john-smith"
"Kurt Gödel".parameterize # =&gt; "kurt-godel"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-9cecbda39cbbe18e63e03861113159ce">Copy</button>
</div>
<p>To preserve the case of the string, set the <code>preserve_case</code> argument to true. By default, <code>preserve_case</code> is set to false.</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"John Smith"</span><span class="p">.</span><span class="nf">parameterize</span><span class="p">(</span><span class="ss">preserve_case: </span><span class="kp">true</span><span class="p">)</span> <span class="c1"># =&gt; "John-Smith"</span>
<span class="s2">"Kurt Gödel"</span><span class="p">.</span><span class="nf">parameterize</span><span class="p">(</span><span class="ss">preserve_case: </span><span class="kp">true</span><span class="p">)</span> <span class="c1"># =&gt; "Kurt-Godel"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-ac99a409abd1c9829f4e0b7dbd1bd670">"John Smith".parameterize(preserve_case: true) # =&gt; "John-Smith"
"Kurt Gödel".parameterize(preserve_case: true) # =&gt; "Kurt-Godel"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-ac99a409abd1c9829f4e0b7dbd1bd670">Copy</button>
</div>
<p>To use a custom separator, override the <code>separator</code> argument.</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"John Smith"</span><span class="p">.</span><span class="nf">parameterize</span><span class="p">(</span><span class="ss">separator: </span><span class="s2">"_"</span><span class="p">)</span> <span class="c1"># =&gt; "john\_smith"</span>
<span class="s2">"Kurt Gödel"</span><span class="p">.</span><span class="nf">parameterize</span><span class="p">(</span><span class="ss">separator: </span><span class="s2">"_"</span><span class="p">)</span> <span class="c1"># =&gt; "kurt\_godel"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-50f0afbe2bf113062493ec062e3cea43">"John Smith".parameterize(separator: "_") # =&gt; "john\_smith"
"Kurt Gödel".parameterize(separator: "_") # =&gt; "kurt\_godel"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-50f0afbe2bf113062493ec062e3cea43">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="tableize"><a class="anchorlink" href="#tableize">5.12.10 <code>tableize</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-tableize"><code>tableize</code></a> is <code>underscore</code> followed by <code>pluralize</code>.</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Person"</span><span class="p">.</span><span class="nf">tableize</span>      <span class="c1"># =&gt; "people"</span>
<span class="s2">"Invoice"</span><span class="p">.</span><span class="nf">tableize</span>     <span class="c1"># =&gt; "invoices"</span>
<span class="s2">"InvoiceLine"</span><span class="p">.</span><span class="nf">tableize</span> <span class="c1"># =&gt; "invoice_lines"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-f0b39d7048781d602c56306c2e5b1361">"Person".tableize      # =&gt; "people"
"Invoice".tableize     # =&gt; "invoices"
"InvoiceLine".tableize # =&gt; "invoice_lines"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-f0b39d7048781d602c56306c2e5b1361">Copy</button>
</div>
<p>As a rule of thumb, <code>tableize</code> returns the table name that corresponds to a given model for simple cases. The actual implementation in Active Record is not straight <code>tableize</code> indeed, because it also demodulizes the class name and checks a few options that may affect the returned string.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="classify"><a class="anchorlink" href="#classify">5.12.11 <code>classify</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-classify"><code>classify</code></a> is the inverse of <code>tableize</code>. It gives you the class name corresponding to a table name:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"people"</span><span class="p">.</span><span class="nf">classify</span>        <span class="c1"># =&gt; "Person"</span>
<span class="s2">"invoices"</span><span class="p">.</span><span class="nf">classify</span>      <span class="c1"># =&gt; "Invoice"</span>
<span class="s2">"invoice_lines"</span><span class="p">.</span><span class="nf">classify</span> <span class="c1"># =&gt; "InvoiceLine"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-f9bb0b4029ad87d6f57f4c6abecaa5b4">"people".classify        # =&gt; "Person"
"invoices".classify      # =&gt; "Invoice"
"invoice_lines".classify # =&gt; "InvoiceLine"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-f9bb0b4029ad87d6f57f4c6abecaa5b4">Copy</button>
</div>
<p>The method understands qualified table names:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"highrise_production.companies"</span><span class="p">.</span><span class="nf">classify</span> <span class="c1"># =&gt; "Company"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-e1230d6dd08c05cfdbd29823c0d9a904">"highrise_production.companies".classify # =&gt; "Company"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-e1230d6dd08c05cfdbd29823c0d9a904">Copy</button>
</div>
<p>Note that <code>classify</code> returns a class name as a string. You can get the actual class object by invoking <code>constantize</code> on it, explained next.</p>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="constantize"><a class="anchorlink" href="#constantize">5.12.12 <code>constantize</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-constantize"><code>constantize</code></a> resolves the constant reference expression in its receiver:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"Integer"</span><span class="p">.</span><span class="nf">constantize</span> <span class="c1"># =&gt; Integer</span>

<span class="k">module</span> <span class="nn">M</span>
  <span class="no">X</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">end</span>
<span class="s2">"M::X"</span><span class="p">.</span><span class="nf">constantize</span> <span class="c1"># =&gt; 1</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-c1ee63c3dccefad7d022d097d1d01444">"Integer".constantize # =&gt; Integer

module M
  X = 1
end
"M::X".constantize # =&gt; 1
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-c1ee63c3dccefad7d022d097d1d01444">Copy</button>
</div>
<p>If the string evaluates to no known constant, or its content is not even a valid constant name, <code>constantize</code> raises <code>NameError</code>.</p>

<p>Constant name resolution by <code>constantize</code> starts always at the top-level <code>Object</code> even if there is no leading "::".</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="no">X</span> <span class="o">=</span> <span class="ss">:in_Object</span>
<span class="k">module</span> <span class="nn">M</span>
  <span class="no">X</span> <span class="o">=</span> <span class="ss">:in_M</span>

  <span class="no">X</span>                 <span class="c1"># =&gt; :in_M</span>
  <span class="s2">"::X"</span><span class="p">.</span><span class="nf">constantize</span> <span class="c1"># =&gt; :in_Object</span>
  <span class="s2">"X"</span><span class="p">.</span><span class="nf">constantize</span>   <span class="c1"># =&gt; :in_Object (!)</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-7979fe40dcf0c022d19281eb9dacdfba">X = :in_Object
module M
  X = :in_M

  X                 # =&gt; :in_M
  "::X".constantize # =&gt; :in_Object
  "X".constantize   # =&gt; :in_Object (!)
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-7979fe40dcf0c022d19281eb9dacdfba">Copy</button>
</div>
<p>So, it is in general not equivalent to what Ruby would do in the same spot, had a real constant be evaluated.</p>

<p>Mailer test cases obtain the mailer being tested from the name of the test class using <code>constantize</code>:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># action_mailer/test_case.rb</span>
<span class="k">def</span> <span class="nf">determine_default_mailer</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
  <span class="nb">name</span><span class="p">.</span><span class="nf">delete_suffix</span><span class="p">(</span><span class="s2">"Test"</span><span class="p">).</span><span class="nf">constantize</span>
<span class="k">rescue</span> <span class="no">NameError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="k">raise</span> <span class="no">NonInferrableMailerError</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-8aa1e10de9fd8b47bea615559ce60fa5"># action_mailer/test_case.rb
def determine_default_mailer(name)
  name.delete_suffix("Test").constantize
rescue NameError =&gt; e
  raise NonInferrableMailerError.new(name)
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-8aa1e10de9fd8b47bea615559ce60fa5">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="humanize"><a class="anchorlink" href="#humanize">5.12.13 <code>humanize</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-humanize"><code>humanize</code></a> tweaks an attribute name for display to end users.</p>

<p>Specifically, it performs these transformations:</p>
<ul>
<li>Applies human inflection rules to the argument.</li>
<li>Deletes leading underscores, if any.</li>
<li>Removes a "_id" suffix if present.</li>
<li>Replaces underscores with spaces, if any.</li>
<li>Downcases all words except acronyms.</li>
<li>Capitalizes the first word.</li>
</ul>
<p>The capitalization of the first word can be turned off by setting the
<code>:capitalize</code> option to false (default is true).</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"name"</span><span class="p">.</span><span class="nf">humanize</span>                         <span class="c1"># =&gt; "Name"</span>
<span class="s2">"author_id"</span><span class="p">.</span><span class="nf">humanize</span>                    <span class="c1"># =&gt; "Author"</span>
<span class="s2">"author_id"</span><span class="p">.</span><span class="nf">humanize</span><span class="p">(</span><span class="ss">capitalize: </span><span class="kp">false</span><span class="p">)</span> <span class="c1"># =&gt; "author"</span>
<span class="s2">"comments_count"</span><span class="p">.</span><span class="nf">humanize</span>               <span class="c1"># =&gt; "Comments count"</span>
<span class="s2">"_id"</span><span class="p">.</span><span class="nf">humanize</span>                          <span class="c1"># =&gt; "Id"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-f1573ae02378d77a0a7363e02decf8d5">"name".humanize                         # =&gt; "Name"
"author_id".humanize                    # =&gt; "Author"
"author_id".humanize(capitalize: false) # =&gt; "author"
"comments_count".humanize               # =&gt; "Comments count"
"_id".humanize                          # =&gt; "Id"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-f1573ae02378d77a0a7363e02decf8d5">Copy</button>
</div>
<p>If "SSL" was defined to be an acronym:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s1">'ssl_error'</span><span class="p">.</span><span class="nf">humanize</span> <span class="c1"># =&gt; "SSL error"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-865910303b56499bd086224c49160592">'ssl_error'.humanize # =&gt; "SSL error"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-865910303b56499bd086224c49160592">Copy</button>
</div>
<p>The helper method <code>full_messages</code> uses <code>humanize</code> as a fallback to include
attribute names:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">full_messages</span>
  <span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">attribute</span><span class="p">,</span> <span class="n">message</span><span class="o">|</span> <span class="n">full_message</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">full_message</span>
  <span class="c1"># ...</span>
  <span class="n">attr_name</span> <span class="o">=</span> <span class="n">attribute</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">tr</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">).</span><span class="nf">humanize</span>
  <span class="n">attr_name</span> <span class="o">=</span> <span class="vi">@base</span><span class="p">.</span><span class="nf">class</span><span class="p">.</span><span class="nf">human_attribute_name</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="ss">default: </span><span class="n">attr_name</span><span class="p">)</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-2df51296f0234ed22241d2fea08c963b">def full_messages
  map { |attribute, message| full_message(attribute, message) }
end

def full_message
  # ...
  attr_name = attribute.to_s.tr('.', '_').humanize
  attr_name = @base.class.human_attribute_name(attribute, default: attr_name)
  # ...
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-2df51296f0234ed22241d2fea08c963b">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h5 id="foreign-key"><a class="anchorlink" href="#foreign-key">5.12.14 <code>foreign_key</code></a></h5>

<p>The method <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-foreign_key"><code>foreign_key</code></a> gives a foreign key column name from a class name. To do so it demodulizes, underscores, and adds "_id":</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"User"</span><span class="p">.</span><span class="nf">foreign_key</span>           <span class="c1"># =&gt; "user_id"</span>
<span class="s2">"InvoiceLine"</span><span class="p">.</span><span class="nf">foreign_key</span>    <span class="c1"># =&gt; "invoice_line_id"</span>
<span class="s2">"Admin::Session"</span><span class="p">.</span><span class="nf">foreign_key</span> <span class="c1"># =&gt; "session_id"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-a16841a9cf0788d195e5cc506089131d">"User".foreign_key           # =&gt; "user_id"
"InvoiceLine".foreign_key    # =&gt; "invoice_line_id"
"Admin::Session".foreign_key # =&gt; "session_id"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-a16841a9cf0788d195e5cc506089131d">Copy</button>
</div>
<p>Pass a false argument if you do not want the underscore in "_id":</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"User"</span><span class="p">.</span><span class="nf">foreign_key</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span> <span class="c1"># =&gt; "userid"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-750e1208d04fef789568a9dc4178f399">"User".foreign_key(false) # =&gt; "userid"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-750e1208d04fef789568a9dc4178f399">Copy</button>
</div>
<p>Associations use this method to infer foreign keys, for example <code>has_one</code> and <code>has_many</code> do this:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># active_record/associations.rb</span>
<span class="n">foreign_key</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="ss">:foreign_key</span><span class="p">]</span> <span class="o">||</span> <span class="n">reflection</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">name</span><span class="p">.</span><span class="nf">foreign_key</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-8b24fabffd06c44c901d9578298a70d6"># active_record/associations.rb
foreign_key = options[:foreign_key] || reflection.active_record.name.foreign_key
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-8b24fabffd06c44c901d9578298a70d6">Copy</button>
</div>
<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/inflections.rb">active_support/core_ext/string/inflections.rb</a></code>.</p></div>

<h4 id="extensions-to-string-conversions"><a class="anchorlink" href="#extensions-to-string-conversions">5.13 Conversions</a></h4>

<h5 id="to-date-to-time-to-datetime"><a class="anchorlink" href="#to-date-to-time-to-datetime">5.13.1 <code>to_date</code>, <code>to_time</code>, <code>to_datetime</code></a></h5>

<p>The methods <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-to_date"><code>to_date</code></a>, <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-to_time"><code>to_time</code></a>, and <a href="https://api.rubyonrails.org/v6.1.7.3/classes/String.html#method-i-to_datetime"><code>to_datetime</code></a> are basically convenience wrappers around <code>Date._parse</code>:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"2010-07-27"</span><span class="p">.</span><span class="nf">to_date</span>              <span class="c1"># =&gt; Tue, 27 Jul 2010</span>
<span class="s2">"2010-07-27 23:37:00"</span><span class="p">.</span><span class="nf">to_time</span>     <span class="c1"># =&gt; 2010-07-27 23:37:00 +0200</span>
<span class="s2">"2010-07-27 23:37:00"</span><span class="p">.</span><span class="nf">to_datetime</span> <span class="c1"># =&gt; Tue, 27 Jul 2010 23:37:00 +0000</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-91f2b487e9830d72a718c1f8a8be0967">"2010-07-27".to_date              # =&gt; Tue, 27 Jul 2010
"2010-07-27 23:37:00".to_time     # =&gt; 2010-07-27 23:37:00 +0200
"2010-07-27 23:37:00".to_datetime # =&gt; Tue, 27 Jul 2010 23:37:00 +0000
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-91f2b487e9830d72a718c1f8a8be0967">Copy</button>
</div>
<p><code>to_time</code> receives an optional argument <code>:utc</code> or <code>:local</code>, to indicate which time zone you want the time in:</p>

<div class="code_container">
<pre><code class="highlight ruby"><span class="s2">"2010-07-27 23:42:00"</span><span class="p">.</span><span class="nf">to_time</span><span class="p">(</span><span class="ss">:utc</span><span class="p">)</span>   <span class="c1"># =&gt; 2010-07-27 23:42:00 UTC</span>
<span class="s2">"2010-07-27 23:42:00"</span><span class="p">.</span><span class="nf">to_time</span><span class="p">(</span><span class="ss">:local</span><span class="p">)</span> <span class="c1"># =&gt; 2010-07-27 23:42:00 +0200</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-14e4724653729924e3a1da83b6180d86">"2010-07-27 23:42:00".to_time(:utc)   # =&gt; 2010-07-27 23:42:00 UTC
"2010-07-27 23:42:00".to_time(:local) # =&gt; 2010-07-27 23:42:00 +0200
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-14e4724653729924e3a1da83b6180d86">Copy</button>
</div>
<p>Default is <code>:local</code>.</p>

<p>Please refer to the documentation of <code>Date._parse</code> for further details.</p>

<div class="info"><p>The three of them return <code>nil</code> for blank receivers.</p></div>

<div class="note"><p>Defined in <code><a href="https://github.com/rails/rails/tree/v6.1.7.3/activesupport/lib/active_support/core_ext/string/conversions.rb">active_support/core_ext/string/conversions.rb</a></code>.</p></div>
</body>
</html>
